<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Electrical Engineering Objective Assessment - 10 Minutes</title>
    <style>
        /* CSS for mobile-friendly view */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f9;
        }
        .container {
            width: 95%;
            max-width: 700px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }
        header {
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid #007bff;
            margin-bottom: 20px;
        }
        .timer-box {
            background-color: #ffdddd;
            color: #d9534f;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-size: 1.4em;
            font-weight: bold;
            margin-bottom: 25px;
            border: 1px solid #d9534f;
        }
        .question-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background-color: #fafafa;
        }
        .question-section h2 {
            border-bottom: 1px solid #ccc;
            padding-bottom: 10px;
            margin-top: 0;
            color: #007bff;
        }
        .question {
            margin-bottom: 20px;
            padding: 10px;
            border-bottom: 1px dashed #eee;
        }
        .question p {
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 1.05em;
        }
        .option-group label {
            display: block;
            margin-bottom: 5px;
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
        }
        .option-group label:hover {
            background-color: #e9f5ff;
        }
        input[type="text"] {
            width: 90%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        input[type="submit"] {
            display: block;
            width: 100%;
            padding: 12px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1.2em;
            cursor: pointer;
            margin-top: 25px;
            transition: background-color 0.3s;
        }
        input[type="submit"]:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        #errorRollNo {
            color: #d9534f;
            font-weight: bold;
            margin-top: 5px;
        }
        #resultDisplay, #expiredDisplay {
            margin-top: 20px;
            padding: 20px;
            border-radius: 8px;
            font-size: 1.1em;
            text-align: center;
            display: none; /* Hidden initially */
        }
        #resultDisplay {
             border: 2px solid #28a745;
             background-color: #e6ffed;
        }
        #expiredDisplay {
             border: 2px solid #d9534f;
             background-color: #ffcccc;
             color: #d9534f;
             font-weight: bold;
             font-size: 1.3em;
        }
        #submittedScore {
            font-size: 1.8em;
            color: #007bff;
            font-weight: bold;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Electrical Engineering Objective Exam</h1>
        <p>10 Multiple-Choice Questions | Time Limit: 10 Minutes</p>
    </header>

    <div class="timer-box">
        Time Remaining: <span id="timer">10:00</span>
    </div>

    <form id="assessmentForm">
        <div class="question-section">
            <h2>Registration Details</h2>
            <div class="question">
                <label for="rollNo">Roll No. (Alphanumeric Only):</label>
                <input type="text" id="rollNo" name="rollNo" pattern="[a-zA-Z0-9]+" title="Roll Number must be alphanumeric (letters and numbers) only." required>
                <div id="errorRollNo"></div>
            </div>
        </div>

        <div class="question-section">
            <h2>Objective Questions (10 Marks)</h2>
            
            <div class="question" id="q1">
                <p>1. A single-phase induction motor is generally not self-starting because:</p>
                <div class="option-group">
                    <label><input type="radio" name="q1" value="A" required> A) It has low resistance</label>
                    <label><input type="radio" name="q1" value="B"> B) It operates at high slip</label>
                    <label><input type="radio" name="q1" value="C"> C) It produces a non-rotating field</label>
                    <label><input type="radio" name="q1" value="D"> D) Its rotor is short-circuited</label>
                </div>
            </div>
            
            <div class="question" id="q2">
                <p>2. Which component is used for **power factor improvement**?</p>
                <div class="option-group">
                    <label><input type="radio" name="q2" value="A" required> A) Inductor</label>
                    <label><input type="radio" name="q2" value="B"> B) Resistor</label>
                    <label><input type="radio" name="q2" value="C"> C) Capacitor</label>
                    <label><input type="radio" name="q2" value="D"> D) Transformer</label>
                </div>
            </div>

            <div class="question" id="q3">
                <p>3. The core of a transformer is laminated to reduce:</p>
                <div class="option-group">
                    <label><input type="radio" name="q3" value="A" required> A) Copper losses</label>
                    <label><input type="radio" name="q3" value="B"> B) Hysteresis losses</label>
                    <label><input type="radio" name="q3" value="C"> C) Eddy current losses</label>
                    <label><input type="radio" name="q3" value="D"> D) Mechanical losses</label>
                </div>
            </div>

            <div class="question" id="q4">
                <p>4. Which machine’s performance is defined by its **torque-slip characteristic**?</p>
                <div class="option-group">
                    <label><input type="radio" name="q4" value="A" required> A) DC Shunt Motor</label>
                    <label><input type="radio" name="q4" value="B"> B) Auto-transformer</label>
                    <label><input type="radio" name="q4" value="C"> C) Synchronous Generator</label>
                    <label><input type="radio" name="q4" value="D"> D) Three-Phase Induction Motor</label>
                </div>
            </div>

            <div class="question" id="q5">
                <p>5. The relation between **line voltage** ($V_L$) and **phase voltage** ($V_{ph}$) in a **Star connection** is:</p>
                <div class="option-group">
                    <label><input type="radio" name="q5" value="A" required> A) $V_L = 1.732 V_{ph}$ ($\sqrt{3} V_{ph}$)</label>
                    <label><input type="radio" name="q5" value="B"> B) $V_L = 3 V_{ph}$</label>
                    <label><input type="radio" name="q5" value="C"> C) $V_L = V_{ph}$</label>
                    <label><input type="radio" name="q5" value="D"> D) None of the above</label>
                </div>
            </div>

            <div class="question" id="q6">
                <p>6. Which component is primarily used to detect **earth leakage current**?</p>
                <div class="option-group">
                    <label><input type="radio" name="q6" value="A" required> A) SFU (Switch Fuse Unit)</label>
                    <label><input type="radio" name="q6" value="B"> B) ELCB (Earth Leakage Circuit Breaker)</label>
                    <label><input type="radio" name="q6" value="C"> C) MLCB</label>
                    <label><input type="radio" name="q6" value="D"> D) MCCB (Moulded Case Circuit Breaker)</label>
                </div>
            </div>

            <div class="question" id="q7">
                <p>7. The unit of **reactive power** is:</p>
                <div class="option-group">
                    <label><input type="radio" name="q7" value="A" required> A) Watt (W)</label>
                    <label><input type="radio" name="q7" value="B"> B) Volt-Ampere Reactive (VAR)</label>
                    <label><input type="radio" name="q7" value="C"> C) Volt-Ampere (VA)</label>
                    <label><input type="radio" name="q7" value="D"> D) Ohm ($\Omega$)</label>
                </div>
            </div>

            <div class="question" id="q8">
                <p>8. An **auto-transformer** has:</p>
                <div class="option-group">
                    <label><input type="radio" name="q8" value="A" required> A) Two separate windings</label>
                    <label><input type="radio" name="q8" value="B"> B) No core</label>
                    <label><input type="radio" name="q8" value="C"> C) Three windings</label>
                    <label><input type="radio" name="q8" value="D"> D) A single winding</label>
                </div>
            </div>

            <div class="question" id="q9">
                <p>9. The purpose of using an **MCB** is to provide protection against:</p>
                <div class="option-group">
                    <label><input type="radio" name="q9" value="A" required> A) Low voltage</label>
                    <label><input type="radio" name="q9" value="B"> B) Overcurrent and short circuit</label>
                    <label><input type="radio" name="q9" value="C"> C) Power factor correction</label>
                    <label><input type="radio" name="q9" value="D"> D) Radio interference</label>
                </div>
            </div>

            <div class="question" id="q10">
                <p>10. Batteries store energy in which form?</p>
                <div class="option-group">
                    <label><input type="radio" name="q10" value="A" required> A) Thermal</label>
                    <label><input type="radio" name="q10" value="B"> B) Mechanical</label>
                    <label><input type="radio" name="q10" value="C"> C) Chemical</label>
                    <label><input type="radio" name="q10" value="D"> D) Nuclear</label>
                </div>
            </div>
        </div>

        <input type="submit" value="Final Submit" id="submitButton">
    </form>

    <div id="resultDisplay">
        <p>✅ **Assessment Completed!**</p>
        <p>Roll No.: <span id="submittedRollNo"></span></p>
        <p>Your Score is:</p>
        <p><span id="submittedScore"></span> / 10</p>
        <p>Thank you for taking the examination.</p>
    </div>

    <div id="expiredDisplay">
        <p>⚠️ **Your Exam Session Expired**</p>
        <p>This Roll Number has already submitted the examination.</p>
        <p>Request **Nagarjuna Sir** For Exam Session Revalidation.</p>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('assessmentForm');
        const timerDisplay = document.getElementById('timer');
        const submitButton = document.getElementById('submitButton');
        const rollNoInput = document.getElementById('rollNo');
        const errorRollNo = document.getElementById('errorRollNo');
        const resultDisplay = document.getElementById('resultDisplay');
        const expiredDisplay = document.getElementById('expiredDisplay');
        const submittedRollNoSpan = document.getElementById('submittedRollNo');
        const submittedScoreSpan = document.getElementById('submittedScore');
        
        // --- Configuration ---
        const totalTimeMinutes = 10;
        let timeRemaining = totalTimeMinutes * 60; 
        let timerInterval;

        // Define correct answers for scoring (Q[number]: Answer_Option)
        const CORRECT_ANSWERS = {
            q1: 'C', q2: 'C', q3: 'C', q4: 'D', q5: 'A',
            q6: 'B', q7: 'B', q8: 'D', q9: 'B', q10: 'C'
        };

        // --- Core Functions ---

        // Function to disable all form elements
        const disableForm = (message, color = '#d9534f') => {
            clearInterval(timerInterval); // Stop the timer
            const inputs = form.querySelectorAll('input, select, textarea, button');
            inputs.forEach(input => input.disabled = true);
            submitButton.value = message;
            submitButton.style.backgroundColor = color;
            submitButton.disabled = true;
        };
        
        // Function to check if Roll No. has already submitted (simulated expiry)
        const checkExistingSubmission = (rollNo) => {
            // Check if the Roll No. exists in local storage
            const submittedRolls = JSON.parse(localStorage.getItem('submittedRolls')) || [];
            return submittedRolls.includes(rollNo);
        };

        // Display the expired message
        const showExpired = () => {
            form.style.display = 'none';
            timerDisplay.closest('.timer-box').style.display = 'none';
            expiredDisplay.style.display = 'block';
            disableForm("Session Expired");
        };

        // Roll Number Validation and Expiry Check on input
        const validateAndCheckRollNo = (event) => {
            const rollNoValue = rollNoInput.value.toUpperCase();
            const alphanumericRegex = /^[a-zA-Z0-9]+$/; 
            
            errorRollNo.textContent = "";

            if (!rollNoValue) {
                // Do nothing if empty, let 'required' handle it on submit
                return false; 
            } else if (!alphanumericRegex.test(rollNoValue)) {
                errorRollNo.textContent = "Error: Roll No. must contain only letters and numbers (alphanumeric).";
                return false;
            } else if (checkExistingSubmission(rollNoValue)) {
                // If roll number is valid AND already submitted, show expired screen
                showExpired();
                return false; 
            }
            
            return true;
        };

        // --- Submission & Scoring Logic ---
        const calculateScore = (formData) => {
            let score = 0;
            for (const question in CORRECT_ANSWERS) {
                // Use a standard name convention (q1, q2, ...)
                const studentAnswer = formData.get(question);
                if (studentAnswer && studentAnswer === CORRECT_ANSWERS[question]) {
                    score++;
                }
            }
            return score;
        };

        const handleSubmit = (event) => {
            if (event) event.preventDefault();
            
            const rollNo = rollNoInput.value.toUpperCase();
            
            // Final validation check
            if (!validateAndCheckRollNo(null)) {
                alert("Please correct your Roll No. or contact the administrator if your session is expired.");
                return;
            }

            // 1. Calculate Score
            const formData = new FormData(form);
            const score = calculateScore(formData);
            
            // 2. Mark Roll No. as submitted in local storage
            const submittedRolls = JSON.parse(localStorage.getItem('submittedRolls')) || [];
            if (!submittedRolls.includes(rollNo)) {
                submittedRolls.push(rollNo);
                localStorage.setItem('submittedRolls', JSON.stringify(submittedRolls));
            }

            // 3. Display Results
            submittedRollNoSpan.textContent = rollNo;
            submittedScoreSpan.textContent = score;
            form.style.display = 'none';
            timerDisplay.closest('.timer-box').style.display = 'none';
            resultDisplay.style.display = 'block';

            // 4. Disable form
            disableForm("Assessment Submitted Successfully!", '#28a745');
        };

        // --- Timer Logic ---
        const startTimer = () => {
            timerInterval = setInterval(() => {
                const minutes = Math.floor(timeRemaining / 60);
                const seconds = timeRemaining % 60;

                const formattedTime = (minutes < 10 ? '0' : '') + minutes + ':' + (seconds < 10 ? '0' : '') + seconds;
                timerDisplay.textContent = formattedTime;

                if (timeRemaining <= 120) { // Last 2 minutes highlight
                    timerDisplay.closest('.timer-box').style.backgroundColor = '#ffc0c0';
                }

                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    timerDisplay.textContent = "00:00";
                    alert("Time is up! The assessment will now auto-submit.");
                    handleSubmit();
                    disableForm("Time Over. Auto-Submitted.");
                    return;
                }

                timeRemaining--;
            }, 1000);
        };

        // --- Initialization ---
        
        // Initial check and setup for rollNo input
        rollNoInput.addEventListener('input', validateAndCheckRollNo);
        rollNoInput.addEventListener('blur', validateAndCheckRollNo); // Check on unfocus

        // Event Listeners
        form.addEventListener('submit', handleSubmit);

        // Start the assessment timer
        startTimer();
    });
</script>

</body>
</html>
